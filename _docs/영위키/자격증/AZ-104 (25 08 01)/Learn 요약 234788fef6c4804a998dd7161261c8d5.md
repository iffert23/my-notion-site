# Learn 요약

- **AZ-104: Azure 관리자 필수 조건**
    - 포털 로그인, 리소스 배포, 미리 보기 기능 탐색, 대시보드 사용자 지정 방법
    - 관리, 조작 도구 : Azure Portal, Azure PowerShell, Command-line, Azure Cloud Shell, 모바일 앱
    - Azure SDK(다양한 언어, 프레임워크에 사용 가능), Rest API(Azure 리소스 관리)도 있음
    - Azure Portal에서는 반복적인 작업 자동화 안됨, 반복되는 복잡한 작업을 하려면 Azure PowerShell, Azure CLI가 유용할 수 있음
    - 홈>왼쪽 사이드바에는 즐겨찾기한 거 나옴
    - 코파일럿 : 사용 가능한 경우에는 질문, 서비스나 리소스로 빠르게 이동하거나 작업에 대한 도움말 볼수있음
    - 글로벌컨트롤(코파일럿 오른쪽들) : 작업중인 서비스 상관없이 사용할 수 있는 전역컨트롤
    - Market Place : 새 리소스를 만들 때 Azure Market Place에서 시작하는 경우가 많음, 검색창에 검색하면 나옴, 자체 Azure 환경에서 호스팅되는 end-to-end 솔루션 배포 가능
    - Advisor : 고가용성, 보안, 성능, 뛰어난 운영, 비용에 대한 권장 사항 제공, 추천 보거나 PDF, CSV 볼 수 있음
    - 연습 - 리소스 활용하기 (그냥 리소스 찾는방법 얘기인듯)
        - 1. 타고 타고 들어가서 리소스 찾기
        홈페이지 리소스 만들기 선택 > 서비스 메뉴에서 컴퓨팅 선택 > MarketPlace에서 자세히 보기 > 운영체제 섹션에서 ‘Windows Server’ 라는 이름의 리소스 선택 > 사용 가능한 모든 리소스 뭐 있는지 보기 > 오른쪽 위 모서리에 있는 X버튼 눌러서 창 다 닫고 홈으로 돌아가기
        - 2. 검색하기
        홈페이지 리소스 만들기 선택 > 검색 서비스 검색 상자에 검색어(virtual machine) 입력하고 Enter > 서비스 메뉴 범주에서 보안 선택 > 뭐 하나 선택해서  자세히 알아보려면 결과를 선택하라는데 안보임;; > 다른 제품 탐색 > 오른쪽 위 모서리에 있는 X버튼 눌러서 창 다 닫고 홈으로 돌아가기
    - 연습 - Portal 기본 메뉴 설정
        - 왼쪽 메뉴 표시 > 모든 서비스 > 왼쪽메뉴 ‘모두’ > 가상머신 > + 만들기 > Azure 가상 머신 > 가상 머신 만들기 창 나옴 > 거기서 뭔가 많은 입력이 가능하다.
        나머지는 중요하지 않고 그때그때 메뉴 눌러가면서 봐도 될 듯
    - Azure Portal 대시보드 : 별 거 되게 많음, 대시보드 만들기, 편집, 내보내기, 공유, 복제, 삭제 등등
    - 연습 - 대시보드 사용자 지정
        - 새 대시보드 만들기
            - 포털 메뉴 > 대시보드 > 만들기 > 사용자 지정 > 대시보드 이름 지정 (거기서 바로 저장 안해도 됨)
        - 시계 타일 추가 및 구성 (타일 이름 : 시간)
            - 타일 갤러리(오른쪽) > 시간(시계) 타일을 왼쪽으로 드롭다운 > 미리보기 > 시간 타일 우클릭 > 편집 > 위치 변경 > 시간 형식 변경 > 완료 > 저장 > 편집(화면 상단) > 첫번째 시계 밑에 새 시간 타일 배치 > 또다른 위치로 변경 > 그러면 대시보드에 시간대 두 개인 시계 두 개 짜잔
        - 타일 추가 및 크기 조정
            - 편집 > 모든 리소스 선택해서 왼쪽 상단에 드롭다운 > 타일 오른쪽 상단 메뉴버튼 > 6x6 크기 선택 > 타일 오른쪽 하단 모서리 스크롤하면 크기 조절됨 > 저장
        - 대시보드 복제
            - 복제 > 대시보드 이름 변경 > 리소스 그룹 타일 제거 > 저장 > 편집 > 타일 갤러리에서 ‘사용자 및 그룹’, ‘사용자 로그인 요약’ 타일 찾아서 추가 > 저장 > 방금 수정한 대시보드가 현재 대시보드로 표시된다는데 어디에 표시되는거임;; > 뭔지알았다 설정-모양-시작보기-대시보드 해야함 (중간에 설정 설명 건너뛰었더니 놓친듯)
        - 대시보드 공유
            - 공유 > ‘대시보드’ 리소스 그룹에 게시 확인이 선택되어있으면 선택취소 > 리소스 그룹 이름 선택 > 게시 > 창 닫기
        - 대시보드 삭제
            - 대시보드 선택 > 삭제 > 확인
        - 대시보드 다시 설정
            - 대시보드 선택 > 편집 > 작업 영역 중 아무데서나 우클릭 > 기본 상태로 재설정 > 기본상태 어쩌꼬 메시지에서 예 선택 > 저장 > 계정 로그아웃 > 브라우저 종료
    - 미리보기 기능에 엑세스
        - 검색창에 미리 보기 기능 검색 > 선택
        - [https://preview.portal.azure.com](https://preview.portal.azure.com/) ← 포털 전체에 대한 기능 시험 미리보기
        - 피드백 기능으로 피드백 제공가능
        - [https://azure.microsoft.com/ko-kr/updates](https://azure.microsoft.com/ko-kr/updates) ← 업데이트 확인 가능
    
    ---
    
    - Azure Cloud Shell : Azure 리소스를 관리하기 위한 브라우저로 액세스 가능한 명령줄 환경. 일반적으로는 Azure 리소스와 상호작용하려면  구성 요소를 PC나 뭐 등등에 설치해야하지만 Cloud Shell 사용시에는 인증된 대화형 셸이 생성됨
    - 외부에 있는 상황에도 Azure를 관리할 수 있음. 직접 링크를 방문, 포탈 등에서 방문 가능함
    - PowerShell, Bash 중에 선택 가능, 명령어로 리소스 관리 가능
    - Azure Cloud Driver로 파일 업로드 가능하고 파일 상호작용 가능. 파일 열어서 편집할 수 있음
    - Cloud Shell 사용하면 안되는 상황 : 세션이 열린 지 20분이 지나면 세션이 끊어지고 상태가 손실됨, sudo 엑세스 같은 관리자 권한 필요한 경우, 동시에 여러 세션 열어야 하는 경우, 다른 지역의 스토리지가 필요한 경우, 환경이 필요한 도구를 설치해야 하는 경우
    - kubectl을 통해 Azure Kubernetes 클러스터에서 검사 수행 시 : Azure Cloud Shell을 열고 `az aks get-credentials`을 사용하여 kube 구성 파일을 Cloud Shell 세션에 다운로드하고 연결을 설정합니다.
    
    ---
    
    - Bash : Linux용 표준 셸 스크립팅 언어
    - 기본 구문 : `command [options] [arguments]` (-al : 파일 및 디렉토리), (/etc : 경로)
    - 명령 관련 옵션에 대한 자세한 내용을 보려면 `man`(“manual”) 명령을 사용
    - 시연 : `[command] —help`
    - 와일드카드 : *(0개 이상의 일치하는 문자), ?(단일문자), [ ](대소문자구분, 문자범위,파일이름해당)
    - W : 현재 컴퓨터 시스템에 있는 사용자 및 해당 사용자의 작업에 대한 정보
    - Bash I/O 연산자 : < (원본에서 입력을 가져옴), > (화면 이외의 대상으로 출력), >> (동일한 작업 수행하지만 덮어쓰지 않고 추가), | (한 명령의 출력을 다른 명령의 입력으로 파이핑)
    - 리눅스 명령어와 매우 유사함
    
    ---
    
    - PowerShell : 명령줄 셸이자 스크립팅 언어. 리소스 관리, CI/CD 등 처리 가능
    - 기능 : 기본 제공 도움말 시스템, 파이프라인(여러 명령을 순차적으로 실행), 별칭(명령 실행 대체 이름. ls같은거), 텍스트를 통해 개체에서 작동함, cmdlet이 있음(코멘드릿, 공용 런타임에 빌드됨, 개체 입력을 받아들이고 개체를 반환함, 오픈소스임), 다양한 유형의 명령이 있음
    - 연습 - 첫 번째 powershell 명령 실행
        - `$PSVersionTable` : PowerShell Version, 플랫폼, 버전 등등 확인
        - `$PSVersionTable.PSVersion` : PowerShell Version만 확인 (.어쩌구가 특정 속성임)
    - 명령 찾기
        - cmdlet으로 승인된 동사 찾기 : `Get-Verb`
        - 도움말 가져오기 : `Get-Help`
        - 사용 가능한 모든 cmdlet 나열 : `Get-Command`
            - 플래그 -Noun(-명사) : 명사에 관련된 명령 이름의 일부를 대상으로 함
            - 플래그 -Verb (-동사) : 동사와 관련된 명령 이름의 일부를 대상으로 함
    - 연습 - 명령 찾기
        - 위에 써있는 명령어를 사용(응용)해서 Get-Command -Verb Get -Noun File* 명령 결과 봄
    - JSON ARM 템플릿을 사용하면 선언적이고 재사용 가능한 방식으로 프로젝트의 인프라를 지정할 수 있다.
    - ARM 템플릿 : 배포를 위한 인프라 및 구성을 정의하는 JSON 파일. 선언적 구문을 사용함. ARM 템플릿을 사용하면 배포할 항목을 만드는 프로그래밍 명령 시퀀스를 작성하지 않고도 리소스 및 해당 리소스의 속성을 지정하면 Azure Resource Manager가 해당 정보를 사용하여 알아서 리소스 배포함
    - 장점 : 배포 자동화, IaC 사례 사용 가능, 래플리케이션 코드처럼 소스 리포지토리에 IaC 파일을 저장하고 버전 지정 가능
    - Resource Manager 역할 : 리소스가 올바르게 만들어지도록 배포를 오케스트레이션, 가능한 경우 템플릿 배포를 빠르게 하기 위해서 리소스를 병렬로 만듦, 배포가 성공할지 확인하기 위해 배포 시작 전 템플릿 확인
        
        ![ARM 템플릿 파일 요소](Learn%20%EC%9A%94%EC%95%BD/image.png)
        
        ARM 템플릿 파일 요소
        
    - Azure에 ARM 템플릿 배포 : 로컬 템플릿 배포, 연결된 템플릿 배포, 지속적인 배포 파이프라인에서 배포
    - 로컬 템플릿 배포 : Azure PowerShell / Azure CLI가 로컬로 설치되어야 함. > 로그인 `az login` > 리소스 그룹 정의 1. 이미 정의된 리소스 그룹 사용 2. 새 리소스 그룹 만들기 `az group create —name [name] — location “[location]”` > 리소스 그룹에 템플릿을 어쩌고부터는 나중에 할게염..
    - 템플릿에 리소스 추가하기 위해서는 리소스 공급자와 해당 리소스 종류를 알아야 함.
    예를 들어 템플릿에 스토리지 계정 리소스를 추가하려면 `Microsoft.Storage` 리소스 공급자가 필요합니다. 이 공급자의 형식 중 하나는 `storageAccount`입니다. 따라서 리소스 종류가 `Microsoft.Storage/storageAccounts`로 표시됩니다.
    - [Azure  서비스의 리소스 공급자 목록](https://learn.microsoft.com/ko-kr/azure/azure-resource-manager/management/azure-services-resource-providers) (공급자 찾기), [Azure Resource Manager 템플릿의 리소스 정의](https://learn.microsoft.com/ko-kr/azure/templates/) (각 리소스의 속성 이해)
- **AZ-104: Azure 내 ID 및 거버넌스 관리**
    - Active Directory Domain Service(AD DS) : 사용자 계정, 암호 등의 디렉터리 데이터를 저장하는 방법을 제공하고 네트워크 사용자, 관리자, 기타 디바이스 및 서비스에서 이 데이터를 사용할 수 있도록 하는 디렉토리 서비스. (온프레미스)
    - Microsoft Entra ID : PaaS 제품의 일부, 클라우드에서 AD와 거의 비슷한 역할을 수행함. 고객이 소유하고 관리하는 자산이나 고객이 제공하는 서비스의 일종이 아니지만 사용자가 기능을 사용할 수 있음
    - 다단계 인증, ID 보호, 셀프 서비스 암호 재설정 지원 등 AD DS에서 기본적으로 사용할 수 없는 기능도 사용이 가능함.
    - 테넌트 : 개별 Microsoft Entra 인스턴스를 말함. Azure 구독 내에서 여러 개의 테넌트를 만들 수 있음. Microsoft Entra ID를 사용하는 Microsoft 365, Intune 또는 Azure와 같은 Microsoft 클라우드 기반 서비스 구독에 등록한 회사 또는 조직을 나타냄
    - AD DS는 Active Directory 기술 제품군의 구성 요소 중 하나. AD DS와 Microsoft Entra ID의 차이점 (LDAP을 사용하여 쿼리 가능. / REST API를 사용)
        
        ![image.png](Learn%20%EC%9A%94%EC%95%BD/image%201.png)
        
    - Microsoft Entra ID는 로컬 AD DS와 통합될 수 있으므로 Microsoft Entra Connect를 구현하면 사용자는 온-프레미스 AD DS와 Microsoft Entra Domain Services 모두에서 조직 자격 증명을 활용할 수 있습니다. AD DS를 로컬에 배포하지 않은 경우에도 Microsoft Entra Domain Services를 클라우드 전용 서비스로 사용하도록 선택할 수 있습니다. 이를 통해 온-프레미스 또는 클라우드에 단일 도메인 컨트롤러를 배포할 필요 없이 로컬로 배포된 AD DS에서와 유사한 기능을 사용할 수 있습니다. 예를 들어, 조직은 Microsoft Entra 테넌트를 만들고 Microsoft Entra Domain Services를 사용하도록 설정한 다음 온-프레미스 리소스와 Microsoft Entra 테넌트 간에 가상 네트워크를 배포하도록 선택할 수 있습니다. 모든 온-프레미스 사용자 및 서비스가 Microsoft Entra ID의 도메인 서비스를 사용할 수 있도록 이 가상 네트워크에 대해 Microsoft Entra Domain Services를 사용하도록 설정할 수 있습니다.
    - Azure 리소스에 엑세스해야 하는 모든 사용자에게 계정 필요. 계정 → 인증 → 엑세스 토큰 작성 → 사용자에게 권한 부여 → 엑세스할 수 있는 리소스 등등 작업 결정
    - 사용자 정의 방법
        - 클라우드 ID : Entra ID에 존재하는 ID
        - 디렉터리 동기화된 ID : 온프레미스 AD에 존재하는 사용자들.
        - 게스트사용자 : Azure 외부에 존재하는 사용자. ex) 다른 클라우드 공급자의 계정 / Xbox 등등의 계정
    - 연습
    Entra ID 관리 센터 : [https://entra.microsoft.com/#home](https://entra.microsoft.com/#home)
        
        ![image.png](Learn%20%EC%9A%94%EC%95%BD/image%202.png)
        
    - 새 사용자 만들기, 보안 그룹 만들기, 그룹에 라이선스 할당, 최근 삭제된 사용자 복원 또는 제거
    - 그룹 생성, 구성, 관리
    - 그룹 종류
        - 보안 그룹 : 가장 일반적인 그룹 유형, 사용자 그룹의 공유 리소스에 대한 구성원, 컴퓨터 엑세스를 관리하는 데 사용됨.
        - Microsoft 365 그룹 :  여러 공유형 솔루션들에 대한 액세스 권한을 구성원에게 부여하여 협업이 가능하도록 함.
    - 멤버십 유형
        - 할당됨 : 구성원이 수동으로 추가/유지/관리됨.
        - 동적 : 규칙에 따라 구성원이 추가되어 동적 그룹을 만듦. 해당 구성원의 규칙에 의해 제어됨
    - 동적 그룹 : 그룹이 사용될 때마다 수식에 의해 생성됨. 해당 필터와 일치하는 특성 값을 가진 Active Directory의 수신자가 모두 포함됨. 수신자의 속성이 필터와 일치해지면 수신자는 의도치않게 그룹 구성원이 될 수 있고 그룹에 전송되는 메시지를 받을 수 있게 되어버림. 주의!
    - 연습 - 그룹 만들기
    - 디바이스 등록 구성 관리
        - Device-ID 기반으로 보안 및 규정 준수 표준을 충족하는지 확인할 수 있다
        - 디바이스를 통해 어디서나 디바이스, 앱, 서비스에 대한 SSO를 사용할 수 있다.
        - Microsoft Entra 조인 디바이스: 클라우드 우선 또는 클라우드 전용을 원하는 조직을 위한 것이며 클라우드와 온프레미스 앱 및 리소스에 모두 엑세스할 수 있음
        - 조인 디바이스 목표 : 회사 소유 디바이스의 windows 배포, 모든 windows 디바이스에서 조직의 앱 및 리소스에 엑세스, 회사 소유 디바이스의 클라우드 기반 관리, 사용자는 Entra ID 또는 동기화된 AD 회사 또는 학교 계정을 사용하여 로그인함
        - 하이브리드 조인 : 온프레미스 AD와 Entra ID를 씀. 기본 데이터는 온프렘 AD에 있고, 수집되는 사용자 디바이스 정보는 양쪽에 등록됨.
        - 라이선스 관리 : MS 유료 클라우드 서비스를 사용하려면 라이선스가 필요하고 해당 서비스에 엑세스해야하는 각 사용자에게 할당됨. → 그룹별로 라이선스를 일괄 적용할 수 있음
        - 라이선스 오류
            - 라이선스 부족
            - 충돌하는 서비스 계획 ( E1을 사용자에게 직접 할당 후 E3를 사용하는 그룹에 사용자를 할당할경우)
            - 기타 제품은 이 라이선스에 종속됨 (그룹에 지정된 제품 중 하나에 다른 제품의 다른 서비스 계획이 작동하기 위해 사용되어야 하는 서비스 계획이 포함되어 있습니다. 이 오류는 Microsoft Entra ID가 기본 서비스 플랜을 제거하려고 시도할 때 발생합니다. 예를 들어 그룹에서 사용자를 제거하는 경우에 발생할 수 있습니다.)
            - 사용 위치가 허용되지 않음
            - 프록시 주소 중복
            - MS Entra Mail 및 프록시주소 특성 변경 (라이선스 할당 업데이트하는 동안 변경됨, 완료되면 변경가능)
            - 감사 로그의 LicenseAssignmentAttributeConcurrencyException
            - 그룹에 할당된 제품 라이선스가 두 개 이상임
            - 라이선스 그룹이 삭제되는경우
            -