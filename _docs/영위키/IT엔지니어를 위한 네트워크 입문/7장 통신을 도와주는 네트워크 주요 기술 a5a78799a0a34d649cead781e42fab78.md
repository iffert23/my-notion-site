# 7장/ 통신을 도와주는 네트워크 주요 기술

---

### 7.1 NAT

네트워크 주소 변환

**7.1.1 NAT/PAT의 용도와 필요성**

- IPv4 주소 고갈 문제 솔루션
    
    외부에 공개해야 하는 서비스는 공인IP,  일반 사용자PC 등은 사설IP 이용 → 효율적
    
- 보안 강화
사내 IP 주소 체계를 외부로부터 숨길 수 있음
- IP 주소 체계가 같은 두 개의 네트워크 간 통신 가능
    
    사설 네트워크를 내부에서 독립적으로 사용한다면 문제가 되진 않지만 사설IP를 이용해 타 회사와 직접 연결하거나 회사 간 합병으로 서로 통신해야 할 때 충돌방지를 위해 더블NAT를 사용한다.
    
- 불필요한 설정 변경을 줄일 수 있다
    
    기본적으로 통신 사업자 또는 IDC에서 IP를 할당받아 사용하게 되는데 회선 사업자와 IDC를 이전하면 그동안 빌린 공인IP를 다시 사용할 수 없어 다른 IP로 변경해야 한다. 이때 내부 네트워크를 PAT/NAT로 운영하고 있었다면 내부 IP를 변경할 필요가 없다
    

**7.1.2 NAT동작 방식 → IP변환**

![Untitled](7%EC%9E%A5%20%ED%86%B5%EC%8B%A0%EC%9D%84%20%EB%8F%84%EC%99%80%EC%A3%BC%EB%8A%94%20%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%20%EC%A3%BC%EC%9A%94%20%EA%B8%B0%EC%88%A0/Untitled.png)

**7.1.3 PAT동작 방식 → Port 변환**

![Untitled](7%EC%9E%A5%20%ED%86%B5%EC%8B%A0%EC%9D%84%20%EB%8F%84%EC%99%80%EC%A3%BC%EB%8A%94%20%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%20%EC%A3%BC%EC%9A%94%20%EA%B8%B0%EC%88%A0/Untitled%201.png)

**7.1.4 SNAT, DNAT**

SNAT : 출발지 주소 변경

1) 사설→공인 통신 시 사용

2) 다른 대외사와 통신 시 내부 IP주소를 노출하지 않기 위함 (보안)

3) 출발지와 목적지 서버가 동일 대역일 때 로드 밸런서의 구성에 따라 로드밸런서를 거치지 않고 응답할 수 있기 때문에 로드밸런서를 거치게 하기 위해서 사용

DNAT : 목적지 주소 변경

DNAT는 로드 밸런서에서 많이 사용합니다. 사용자는 서비스 요청을 위해 로드 밸런서에 설정된 서비스 VIP(Virtual IP) 로 서비스를 요청하고 로드 밸런서에서는 서비스 VIP 를 로드 밸런싱될 서버
의 실제 IP 로 DNAT해 내보냅니다

2) 대외사의 IP를 특정 IP 대역으로 NAT하는 방법으로 대외망과의 네트워크 구성에서도 사용 (별도 IP별 라우팅 구성 필요 없음)

NAT 장비에 패킷이 처음 통과할 때 NAT 테이블을 생성해 반대로 패킷을 변환한다. → 역NAT

**7.1.5 동적 NAT, 정적NAT**

정적 NAT

- 출발지와 목적지의 IP를 미리 매핑해서 고정
- 방향성 없이 서비스 흐름을 고려하지 않고 NAT를 설정할 수 있음

동적 NAT

- 출발지/목적지를 사전에 정하지 않고 NAT를 수행할 때 IP를 동적으로 변경하는 것
- 출발지 또는 목적지 중 한 곳이 IP Pool이나 Range로 설정되어 있음
    
    → 수행하는 시점에서 IP Pool에서 어떤 IP로 매칭될 것인지 판단해 NAT 테이블을 만들어서 관리
    
    NAT 테이블 타임아웃 문제가 있기 때문에 서비스 흐름을 고려해 적용해야 한다.
    

### 7.2 DNS